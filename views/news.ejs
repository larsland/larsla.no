<!DOCTYPE html>
<html>
    <head>
        <title><%= title %></title>
        <link rel='stylesheet' href='/stylesheets/style.css'>
        <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
        <script src="/javascripts/marked.js"></script>
    </head>
    <body>
        <% include partials/header %>
        <div class="main-container center">
            <div class="row">
                <div class="news-wrapper">
                    <div>
                        <% if(user) { %>
                        <div onclick="togglePostArticleForm()" class="post-btn-container border-box box-shadow pointer center noSelect" id="post-btn">
                            <img class="post-btn-image noSelect" src="icons/pencil2.svg">
                        </div>
                        <% } else {%>
                        <% } %>
                    </div>
                    <div class="submit-container" id="submit-container">
                        <form action="/api/articles" method="POST" target="dummyframe">
                            <p>Title:</p>
                            <input id="titleField" class="input-title center" type="text" name="title"></input><br>
                            <p>Ingress:</p>
                            <input class="input-title center" type="text" name="ingress"></input><br>
                            <p>Content:</p>
                            <textarea id="contentField" rows=15 class="input-text center" name="content"></textarea><br>
                            <input id="submit-btn" type="submit" value="Post" class="input-btn right pointer">
                            <iframe style="display:none" width="0" height="0" border="0" name="dummyframe" id="dummyframe"></iframe>
                        </form>
                    </div>
                    <div class="articles-container">
                    <% for(var i = 0; i < articles.length; i++) { %>
                        <div class="article box-shadow border-box">
                            <% if(user) { %>
                            <a onclick="removeArticleFromPreview()" id="removeArticle" class="right space-left" href="">
                                <input type="hidden" value="<%= articles[i]._id %>">
                                delete
                            </a>
                            <% } %>
                            <a style="display:none"><%= articles[i]._id %></a>
                            <h3 name="article-links"><a href=""><%= articles[i].title %></a></h3>
                            <div class="horizontal-line"></div>
                            <p name="article-ingress"><%= articles[i].ingress %></p>
                        </div>
                    <% } %>
                    </div>
                </div>
            </div>
        </div>
        <% include partials/footer %>
        <script src="/javascripts/highlightNav.js"></script>
        <script src="/javascripts/postValidator.js"></script>
        <% if(user) { %>
        <script src="/javascripts/privateListeners.js"></script>
        <% } %>
        <script src="/javascripts/updateMarkdown.js"></script>
        <script>
            var articleLinks = document.getElementsByName('article-links')
            for (var i = 0; i < articleLinks.length; i++) {
                articleLinks[i].addEventListener('click', function(e) {
                    e.preventDefault();
                    var id = this.previousSibling.previousSibling.innerHTML
                    var link = "/news/" + id;
                    location.href="/news/" + id
                })
            }
        </script>
    </body>
</html>
